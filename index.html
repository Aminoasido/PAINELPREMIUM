<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MeuApp">
    <link rel="apple-touch-icon" href="icon-192.png">
    <title>Instalador PWA</title>
    <link rel="manifest" href="manifest.json">
    
    <style>
        body {
            margin: 0; display: flex; justify-content: center; align-items: center;
            height: 100vh; background-color: #f4f7f6; font-family: -apple-system, sans-serif;
        }
        #installContainer { text-align: center; padding: 20px; }
        
        /* Botão para Android */
        #btnInstalar {
            display: none; background-color: #007bff; color: white; border: none;
            padding: 20px 40px; font-size: 18px; font-weight: bold; border-radius: 50px;
            cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* Instrução para iOS */
        #iosInstruction {
            display: none; background: white; padding: 20px; border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); line-height: 1.6;
        }
        .icon-share { width: 25px; vertical-align: middle; }
    </style>
</head>
<body>

    <div id="installContainer">
        <button id="btnInstalar">INSTALAR APLICATIVO</button>

        <div id="iosInstruction">
            <h3>Instale no seu iPhone</h3>
            <p>1. Toque no ícone de <strong>Compartilhar</strong> <img src="https://img.icons8.com/ios/50/000000/share-rounded.png" class="icon-share"> na barra inferior.</p>
            <p>2. Role para baixo e toque em <strong>"Adicionar à Tela de Início"</strong>.</p>
        </div>

        <p id="statusMsg">Verificando compatibilidade...</p>
    </div>

    <script>
        let installPrompt;
        const btnInstalar = document.getElementById('btnInstalar');
        const iosInstruction = document.getElementById('iosInstruction');
        const statusMsg = document.getElementById('statusMsg');

        // Detectar se é iOS
        const isIos = () => {
            const userAgent = window.navigator.userAgent.toLowerCase();
            return /iphone|ipad|ipod/.test(userAgent);
        }

        // Detectar se já está em modo PWA (já instalado)
        const isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone);

        if (isIos()) {
            if (!isInStandaloneMode()) {
                // Se for iOS e não estiver instalado, mostra a instrução
                iosInstruction.style.display = 'block';
                statusMsg.style.display = 'none';
            } else {
                statusMsg.textContent = "Aplicativo já instalado!";
            }
        }

        // Lógica para Android (Chrome)
        window.addEventListener('beforeinstallprompt', (event) => {
            event.preventDefault();
            installPrompt = event;
            btnInstalar.style.display = 'block';
            statusMsg.style.display = 'none';
        });

        btnInstalar.addEventListener('click', async () => {
            if (installPrompt) {
                await installPrompt.prompt();
                installPrompt = null;
                btnInstalar.style.display = 'none';
            }
        });

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js');
        }
    </script>
</body>
</html>
